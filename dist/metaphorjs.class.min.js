(function(){var m={lib:{},cmp:{},view:{}},q=function(b){return"function"==typeof b},w=Object.prototype.toString,t=function(){var b={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(g){if(!g){if(null===g)return 6;if(void 0===g)return 7}var h=b[w.call(g)];return void 0===h?-1:1==h&&isNaN(g)?8:h}}(),n=function(b){return"string"==typeof b||0===t(b)},u=function(b){if(null===
b||"object"!=typeof b)return!1;b=t(b);return 2<b||-1==b},s=function(b,g){var h={};b||(b="undefined"!=typeof global?global:window);this.register=function(k,l){var f;f=k;var c=f.split("."),a,d=c.pop();a=c.join(".");var e=c.length,r,p=b;if(h[a])f=[h[a],d,f];else{if(0<e)for(a=0;a<e;a++){r=c[a];if(g&&0==a)if(r==g){p=b;continue}else f=g+"."+f;void 0===p[r]&&(p[r]={});p=p[r]}else g&&(f=g+"."+f);f=[p,d,f]}c=f[0];d=f[1];u(c)&&void 0===c[d]&&(c[d]=l,h[f[2]]=l);return l};this.exists=function(b){return void 0!==
h[b]};this.get=function(k,l){if(void 0!==h[k])return h[k];if(g&&void 0!==h[g+"."+k])return h[g+"."+k];if(!l){var f=k.split("."),c,a=f.length,d,e=b;for(c=0;c<a;c++)if(d=f[c],g&&0==c&&d==g)e=b;else{if(void 0===e[d])return;e=e[d]}e&&(h[k]=e);return e}};this.add=function(b,l){g&&0!==b.indexOf(g)&&(b=g+"."+b);void 0===h[b]&&(h[b]=l);return l};this.remove=function(b){delete h[b]}};s.prototype={register:null,exists:null,get:null,add:null,remove:null};var x=Array.prototype.slice,v=function(b){b||(b=new s);
var g=function(c,a){return l(function(){},c,a)},h=function(c,a,d){return function(){var e,b=this.supr;this.supr="__construct"==a?c.prototype[a]||c.prototype.constructor:c.prototype[a]||function(){};e=d.apply(this,arguments);this.supr=b;return e}},k=function(c,a,d){for(var e in a)a.hasOwnProperty(e)&&(c[e]=!q(a[e])||!q(d.prototype[e])&&d.prototype[e]?a[e]:h(d,e,a[e]))},l=function(c,a,d){var e=function(){};e.prototype=c.prototype;e=new e;d&&(a.__construct=d);var b=function(){this.__construct&&this.__construct.apply(this,
arguments);this.initialize&&this.initialize.apply(this,arguments)};k(e,a,c);e.constructor=b;b.prototype=e;b.prototype.getClass=function(){return b.__class};b.prototype.getParentClass=function(){return b.__parentClass};b.__instantiate=function(a){return function(){var b=function(){},c;b.prototype=a.prototype;b=new b;c=a.prototype.constructor.apply(b,arguments);return u(c)?c:b}}(b);return b},f=function(c,a,d,e,f,h){null===c&&(c="");q(c)?(f=d,n(a)?(f=e,e=d):(e=a,d=c,a=null),c=null):n(c)||(f=a,e=c,c=
d=a=null);n(a)||q(a)||(f=e,e=d,d=a,a=null);q(d)||(f=e,e=d,d=null);e=e||{};var k=a&&n(a)?b.get(a):a;if(a&&!k)throw Error(a+" not found");a=k?l(k,e,d):g(e,d);a.__isMetaphorClass=!0;a.__parent=k;a.__parentClass=k?k.__class:null;a.__class=c;if(f)for(var m in f)f.hasOwnProperty(m)&&(a[m]=f[m]);c&&(h?b.add(c,a):b.register(c,a));f&&f.alias&&b.add(f.alias,a);return a};this.factory=function(c){var a=b.get(c),d=x.call(arguments,1);if(!a)throw Error(c+" not found");return a.__instantiate.apply(this,d)};this.isSubclassOf=
function(c,a){var d=c,e=b.get;n(a)||(a=a.getClass?a.getClass():a.prototype.constructor.__class);for(n(c)&&(d=e(c));d;){if(d.prototype.constructor.__class==a)return!0;d&&(d=d.getParentClass?e(d.getParentClass()):d.__parent)}return!1};this.isInstanceOf=function(c,a){var d=n(a)?b.get(a):a;return d?c instanceof d:!1};this.define=f;this.defineCache=function(b,a,d,e,g){return f(b,a,d,e,g,!0)};this.extend=function(b,a,d,e){return f(null,b,a,d,e)}};v.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,
define:null,defineCache:null,extend:null};m.lib.Namespace=s;m.lib.Class=v;"undefined"!=typeof global?global.MetaphorJs=m:window.MetaphorJs=m})();
