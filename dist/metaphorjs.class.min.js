'use strict';(function(){function u(a){return"string"==typeof a||a===""+a}function A(a){if(null===a||"object"!=typeof a)return!1;a=x(a);return 2<a||-1==a}function y(a){return"object"==typeof a&&3===x(a)&&!a.nodeType&&a.constructor===Object}function B(a){return!0===a||!1===a}function v(){}function D(a,h,l,f,b,n){b=b||"before";return function(){var e,d;if("instead"==b)return h.apply(l||f,arguments);"before"==b?(e=h.apply(l||f,arguments),d=!1!==e?a.apply(f||l,arguments):null):(d=a.apply(f||l,arguments),
e=h.apply(l||f,arguments));return n?e:d}}var E=Object.prototype.toString,x=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(h){if(!h){if(null===h)return 6;if(void 0===h)return 7}var l=a[E.call(h)];return void 0===l?-1:1==l&&isNaN(h)?8:l}}(),F=function(){var a,h=function(l){var f={},b=[];0==arguments.length&&(l=!0);return{addFinder:function(a,e,d){b[d?"unshift":
"push"]({fn:a,context:e})},add:function(a,e,d){if(f[a]&&!1===f[a].rewritable)return f[a];f[a]={rewritable:"undefined"!=typeof d?d:l,value:e};return e},get:function(a){if(f[a])return f[a].value;if(b.length){var e,d,c;e=0;for(d=b.length;e<d;e++)if(c=b[e].fn.call(b[e].context,a,this),void 0!==c)return this.add(a,c,!0)}},remove:function(a){var e=f[a];e&&!0===e.rewritable&&delete f[a];return e?e.value:void 0},exists:function(a){return!!f[a]},eachEntry:function(a,e){for(var d in f)a.call(e,f[d].value,d)},
destroy:function(){this===a&&(a=null);this.remove=this.exists=this.destroy=this.get=this.add=l=f=null}}};h.global=function(){a||(a=new h(!0));return a};return h}(),z=function(){var a=function(a,f,b){b=b||new F(!1);var n=f?f.length:null;a||(a="undefined"!=typeof global?global:window);var e=function(c){return c&&f&&c.substr(0,n)!=f?f+"."+c:c},d=function(c,d){c=e(c);if(b.exists(c))return b.get(c);if(!d){var p=c.split("."),q,s=p.length,k,t=a;for(q=0;q<s;q++)if(k=p[q],f&&0==q&&k==f)t=a;else{if(void 0===
t[k])return;t=t[k]}t&&b.add(c,t);return t}};this.register=function(c,d){var p;p=e(c);var q=p.split("."),s,k=q.pop();s=q.join(".");var t=q.length,g,r=a;if(b[s])p=[b[s],k,p];else{if(0<t)for(s=0;s<t;s++)g=q[s],f&&0==s&&g==f?r=a:(void 0===r[g]&&(r[g]={}),r=r[g]);p=[r,k,p]}q=p[0];k=p[1];A(q)&&void 0===q[k]&&(q[k]=d,b.add(p[2],d));return d};this.exists=function(c){return void 0!==d(c,!0)};this.get=d;this.add=function(c,a){c=e(c);b.add(c,a);return a};this.remove=function(a){a=e(a);b.remove(a)};this.normalize=
e;this.makeAlias=function(a,d){a=e(a);d=e(d);var f=b.get(a);void 0!==f&&b.add(d,f)};this.destroy=function(){var a;this===h&&(h=null);b.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});b.destroy();b=null;for(a in this)this[a]=null}};a.prototype.register=null;a.prototype.exists=null;a.prototype.get=null;a.prototype.add=null;a.prototype.remove=null;a.prototype.normalize=null;a.prototype.makeAlias=null;a.prototype.destroy=null;var h;a.global=function(){h||(h=new a);return h};return a}(),C=Array.prototype.slice,
G=function(){return function h(){var l=!1,f=!1,b=C.call(arguments),n=b.shift(),e,d,c;B(b[b.length-1])&&(l=b.pop());B(b[b.length-1])&&(f=l,l=b.pop());for(;b.length;)if(e=b.shift())for(d in e)if(e.hasOwnProperty(d)&&void 0!==(c=e[d]))if(f)if(n[d]&&y(n[d])&&y(c))h(n[d],c,l,f);else{if(!0===l||void 0==n[d])y(c)?(n[d]={},h(n[d],c,l,!0)):n[d]=c}else if(!0===l||void 0==n[d])n[d]=c;return n}}(),H=function(a,h){var l=function(){},f;l.prototype=a.prototype;l=new l;f=a.apply(l,h);return A(f)||!1===f?f:l},I=function(){var a=
function(){this.$super&&this.$super!==v&&this.$super.apply(this,arguments)},h=function(a,d,c){var $super=a.prototype[d]||("$constructor"==d?a:v)||v;return function(){var a,q=this.$super;this.$super=$super;a=c.apply(this,arguments);this.$super=q;return a}},l=function(a,d,c,f){var b,q,s,k=c.prototype;for(b in d)d.hasOwnProperty(b)&&(s=k[b],q=d[b],a[b]="function"!=typeof q||s&&"function"!=typeof s?q:h(c,b,q));f||(a.$plugins=null,a.$pluginMap=null,k.$beforeInit?(a.$beforeInit=k.$beforeInit.slice(),a.$afterInit=
k.$afterInit.slice(),a.$beforeDestroy=k.$beforeDestroy.slice(),a.$afterDestroy=k.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},f=function(a,d){for(var c in d)d.hasOwnProperty(c)&&("$beforeInit"==c?a.$beforeInit.push(d[c]):"$afterInit"==c?a.$afterInit.push(d[c]):"$beforeDestroy"==c?a.$beforeDestroy.push(d[c]):"$afterDestroy"==c?a.$afterDestroy.push(d[c]):a[c]||(a[c]=d[c]))},b=function(e){e||(e=new z);var d=function(a){return function(){var c=[],
k=[],d=arguments,g,b,f,m,l,h;if(!this)throw"Must instantiate via new: "+a;this.$plugins=[];(g=this.$constructor.apply(this,arguments))&&"object"==typeof g&&5===x(g)&&(d=g);f=this.$plugins;l=this.$pluginMap={};g=-1;for(b=this.$beforeInit.length;++g<b;c.push([this.$beforeInit[g],this]));g=-1;for(b=this.$afterInit.length;++g<b;k.push([this.$afterInit[g],this]));if(f&&f.length)for(g=0,b=f.length;g<b;g++){m=f[g];if(u(m)&&(h=m,m=e.get(m,!0),!m))throw h+" not found";m=new m(this,d);l[m.$class]=m;m.$beforeHostInit&&
c.push([m.$beforeHostInit,m]);m.$afterHostInit&&k.push([m.$afterHostInit,m]);f[g]=m}g=-1;for(b=c.length;++g<b;c[g][0].apply(c[g][1],d));this.$init&&this.$init.apply(this,d);g=-1;for(b=k.length;++g<b;k[g][0].apply(k[g][1],d));}},c=function(){};G(c.prototype,{$class:null,$extends:null,$plugins:null,$pluginMap:null,$mixins:null,$destroyed:!1,$constructor:v,$init:v,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$getParentClass:function(){return this.$extends},
$intercept:function(a,c,d,b,g){var e=this[a];this[a]=D(e,c,d||this,this,b,g);return e},$implement:function(a){var c=this.constructor;c&&c.$parent&&l(this,a,c.$parent)},$hasPlugin:function(a){return!!this.$pluginMap[e.normalize(a)]},$getPlugin:function(a){return this.$pluginMap[e.normalize(a)]||null},$destroy:function(){var a=this.$beforeDestroy,c=this.$afterDestroy,d=this.$plugins,b,e,f;if(!this.$destroyed){this.$destroyed=!0;b=-1;for(e=a.length;++b<e;a[b].apply(this,arguments));b=0;for(e=d.length;b<
e;b++)d[b].$beforeHostDestroy&&d[b].$beforeHostDestroy.call(d[b],arguments);f=this.destroy.apply(this,arguments);b=-1;for(e=a.length;++b<e;c[b].apply(this,arguments));b=0;for(e=d.length;b<e;b++)d[b].$destroy.apply(d[b],arguments);if(!1!==f)for(b in this)this.hasOwnProperty(b)&&(this[b]=null);this.$destroyed=!0}},destroy:function(){}});c.$self=c;c.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],
a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return H(this,a)}};c.$override=function(a){var b=this.$self,c=this.$parent;b&&c&&l(b.prototype,a,c)};c.$extend=function(a,b){return h(a,b,this)};c.$destroy=function(){for(var a in this)this[a]=null};var h=function(b,s,k){b=b||{};var h=b.$class,g=k||b.$extends,r=b.$mixins,n,m,p;g?u(g)?k=e.get(g):(k=g,g=k.$class||""):(k=c,g="");if(g&&!k)throw g+" not found";h&&(h=e.normalize(h));b.$class=h;b.$extends=g;b.$mixins=null;n=function(){};n.prototype=
k.prototype;g=new n;n=null;b.$constructor=b.$constructor||a;l(g,b,k);if(r)for(b=0,n=r.length;b<n;b++)p=r[b],u(p)&&(p=e.get(p,!0)),f(g,p);r=d(h);g.constructor=r;r.prototype=g;for(m in c)"prototype"!=m&&c.hasOwnProperty(m)&&(r[m]=c[m]);for(m in k)"prototype"!=m&&k.hasOwnProperty(m)&&(r[m]=k[m]);if(s)for(m in s)"prototype"!=m&&s.hasOwnProperty(m)&&(r[m]=s[m]);r.$parent=k;r.$self=r;h&&e.register(h,r);return r},p=this;p.factory=function(a){var b=e.get(a),c=C.call(arguments,1);if(!b)throw a+" not found";
return b.$instantiate.apply(b,c)};p.isSubclassOf=function(a,b){var c=a,d=e.get;b=u(b)?e.normalize(b):b.prototype.$class;for(u(a)&&(c=d(e.normalize(a)));c&&c.prototype;){if(c.prototype.$class==b)return!0;c=c.$parent}return!1};p.isInstanceOf=function(a,b){var c=u(b)?e.get(b):b;return c?a instanceof c:!1};p.define=h;p.destroy=function(){p===n&&(n=null);c.$destroy();c=null;e.destroy();b=e=null};p.BaseClass=c};b.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,destroy:null};var n;
b.global=function(){n||(n=new b(z.global()));return n};return b}(),w={};w.Namespace=z;w.Class=I;"undefined"!=typeof global?global.MetaphorJs=w:window.MetaphorJs=w})();
