'use strict';(function(){function t(n){return"string"==typeof n||n===""+n}function v(n){return"object"==typeof n&&3===w(n)&&!n.nodeType&&n.constructor===Object}function x(n){return!0===n||!1===n}function r(){}var u={},z=Object.prototype.toString,w=function(){var n={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(g){if(!g){if(null===g)return 6;if(void 0===g)return 7}var e=
n[z.call(g)];return void 0===e?-1:1==e&&isNaN(g)?8:e}}(),p=function(n,g){var e={};n||(n="undefined"!=typeof global?global:window);this.register=function(d,k){var a;a=d;var b=a.split("."),c,l=b.pop();c=b.join(".");var m=b.length,h,s=n;if(e[c])a=[e[c],l,a];else{if(0<m)for(c=0;c<m;c++){h=b[c];if(g&&0==c)if(h==g){s=n;continue}else a=g+"."+a;void 0===s[h]&&(s[h]={});s=s[h]}else g&&(a=g+"."+a);a=[s,l,a]}b=a[0];l=a[1];null===b||"object"!=typeof b?m=!1:(m=w(b),m=2<m||-1==m);m&&void 0===b[l]&&(b[l]=k,e[a[2]]=
k);return k};this.exists=function(d){return void 0!==e[d]};this.get=function(d,k){if(void 0!==e[d])return e[d];if(g&&void 0!==e[g+"."+d])return e[g+"."+d];if(!k){var a=d.split("."),b,c=a.length,l,m=n;for(b=0;b<c;b++)if(l=a[b],g&&0==b&&l==g)m=n;else{if(void 0===m[l])return;m=m[l]}m&&(e[d]=m);return m}};this.add=function(d,k){g&&0!==d.indexOf(g)&&(d=g+"."+d);void 0===e[d]&&(e[d]=k);return k};this.remove=function(d){delete e[d]};this.normalize=function(d){return d&&g&&0!==d.indexOf(g)?g+"."+d:d}};p.prototype.register=
null;p.prototype.exists=null;p.prototype.get=null;p.prototype.add=null;p.prototype.remove=null;p.prototype.normalize=null;var y=Array.prototype.slice,A=function(){return function g(){var e=!1,d=!1,k=y.call(arguments),a=k.shift(),b,c,l;x(k[k.length-1])&&(e=k.pop());x(k[k.length-1])&&(d=e,e=k.pop());for(;k.length;)if(b=k.shift())for(c in b)if(b.hasOwnProperty(c)&&void 0!==(l=b[c]))if(d)if(a[c]&&v(a[c])&&v(l))g(a[c],l,e,d);else{if(!0===e||void 0==a[c])v(l)?(a[c]={},g(a[c],l,e,!0)):a[c]=l}else if(!0===
e||void 0==a[c])a[c]=l;return a}}(),B=function(n,g,e,d,k,a){k=k||"before";return function(){var b,c;if("instead"==k)return g.apply(e||d,arguments);"before"==k?(b=g.apply(e||d,arguments),c=!1!==b?n.apply(d||e,arguments):null):(c=n.apply(d||e,arguments),b=g.apply(e||d,arguments));return a?b:c}},C=function(){var n=function(){this.$super&&this.$super!==r&&this.$super.apply(this,arguments)},g=function(a,b,c){var $super=a.prototype[b]||("$constructor"==b?a:r)||r;return function(){var a,h=this.$super;this.$super=
$super;a=c.apply(this,arguments);this.$super=h;return a}},e=function(a,b,c,d){var e,h,s,f=c.prototype;for(e in b)b.hasOwnProperty(e)&&(s=f[e],h=b[e],a[e]="function"!=typeof h||s&&"function"!=typeof s?h:g(c,e,h));d||(a.$plugins=null,f.$beforeInit?(a.$beforeInit=f.$beforeInit.slice(),a.$afterInit=f.$afterInit.slice(),a.$beforeDestroy=f.$beforeDestroy.slice(),a.$afterDestroy=f.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},d=function(a,b){for(var c in b)b.hasOwnProperty(c)&&
("$beforeInit"==c?a.$beforeInit.push(b[c]):"$afterInit"==c?a.$afterInit.push(b[c]):"$beforeDestroy"==c?a.$beforeDestroy.push(b[c]):"$afterDestroy"==c?a.$afterDestroy.push(b[c]):a[c]||(a[c]=b[c]))},k=function(a){a||(a=new p);var b=function(){return function(){var h=[],c=[],f,b,e,d,g;if(!this)throw"Must instantiate via new";this.$plugins=[];this.$constructor.apply(this,arguments);e=this.$plugins;f=-1;for(b=this.$beforeInit.length;++f<b;h.push([this.$beforeInit[f],this]));f=-1;for(b=this.$afterInit.length;++f<
b;c.push([this.$afterInit[f],this]));if(e.length)for(f=0,b=e.length;f<b;f++){d=e[f];if(t(d)&&(g=d,d=a.get("plugin."+d,!0),!d))throw g+" not found";d=new d(this,arguments);d.$beforeHostInit&&h.push([d.$beforeHostInit,d]);d.$afterHostInit&&c.push([d.$afterHostInit,d]);e[f]=d}f=-1;for(b=h.length;++f<b;h[f][0].apply(h[f][1],arguments));this.$init&&this.$init.apply(this,arguments);f=-1;for(b=c.length;++f<b;c[f][0].apply(c[f][1],arguments));}},c=function(){};A(c.prototype,{$class:null,$extends:null,$plugins:null,
$mixins:null,$destroyed:!1,$constructor:r,$init:r,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$getParentClass:function(){return this.$extends},$intercept:function(h,a,c,b,d){this[h]=B(this[h],a,c||this,this,b,d)},$implement:function(h){var a=this.constructor;a&&a.$parent&&e(this,h,a.$parent)},$destroy:function(){var a=this.$beforeDestroy,c=this.$afterDestroy,f=this.$plugins,b,d,e;if(!this.$destroyed){this.$destroyed=!0;b=-1;for(d=a.length;++b<
d;a[b].apply(this,arguments));b=0;for(d=f.length;b<d;b++)f[b].$beforeHostDestroy&&f[b].$beforeHostDestroy();e=this.destroy();b=-1;for(d=a.length;++b<d;c[b].apply(this,arguments));b=0;for(d=f.length;b<d;b++)f[b].$destroy();if(!1!==e)for(b in this)this.hasOwnProperty(b)&&(this[b]=null);this.$destroyed=!0}},destroy:function(){}});c.$self=c;c.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],
a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return k(this,a)}};c.$override=function(a){var b=this.$self,c=this.$parent;b&&c&&e(b.prototype,a,c)};c.$extend=function(a,b){return g(a,b,this)};var g=function(h,g,f){h=h||{};var k=h.$class,l=f||h.$extends,m=h.$mixins,p,q,r;l?t(l)?f=a.get(l):(f=l,l=f.$class||""):(f=c,l="");if(l&&!f)throw l+" not found";k&&(k=a.normalize(k));h.$class=k;h.$extends=l;h.$mixins=null;p=function(){};p.prototype=f.prototype;l=new p;p=null;h.$constructor=h.$constructor||
n;e(l,h,f);if(m)for(h=0,p=m.length;h<p;h++)r=m[h],t(r)&&(r=a.get("mixin."+r,!0)),d(l,r);m=b();l.constructor=m;m.prototype=l;for(q in c)"prototype"!=q&&c.hasOwnProperty(q)&&(m[q]=c[q]);for(q in f)"prototype"!=q&&f.hasOwnProperty(q)&&(m[q]=f[q]);if(g)for(q in g)"prototype"!=q&&g.hasOwnProperty(q)&&(m[q]=g[q]);m.$parent=f;m.$self=m;k&&a.register(k,m);return m},k=function(b){var c=a.get(b),d=y.call(arguments,1);if(!c)throw b+" not found";return c.$instantiate.apply(c,d)};this.factory=k;this.isSubclassOf=
function(b,c){var d=b,e=a.get;c=t(c)?a.normalize(c):c.prototype.$class;for(t(b)&&(d=e(a.normalize(b)));d&&d.prototype;){if(d.prototype.$class==c)return!0;d=d.$parent}return!1};this.isInstanceOf=function(b,c){var d=t(c)?a.get(c):c;return d?b instanceof d:!1};this.define=g;this.BaseClass=c};k.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null};return k}();u.Namespace=p;u.Class=C;"undefined"!=typeof global?global.MetaphorJs=u:window.MetaphorJs=u})();
