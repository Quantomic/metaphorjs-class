'use strict';(function(){function t(a){return"string"==typeof a||a===""+a}function y(a){if(null===a||"object"!=typeof a)return!1;a=v(a);return 2<a||-1==a}function w(a){return"object"==typeof a&&3===v(a)&&!a.nodeType&&a.constructor===Object}function z(a){return!0===a||!1===a}function s(){}var B=Object.prototype.toString,v=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};
return function(h){if(!h){if(null===h)return 6;if(void 0===h)return 7}var m=a[B.call(h)];return void 0===m?-1:1==m&&isNaN(h)?8:m}}(),C=function(){var a,h=function(m){var e={},d=[];0==arguments.length&&(m=!0);return{addFinder:function(a,g,b){d[b?"unshift":"push"]({fn:a,context:g})},add:function(a,g,b){if(e[a]&&!1===e[a].rewritable)return e[a];e[a]={rewritable:"undefined"!=typeof b?b:m,value:g};return g},get:function(a){if(e[a])return e[a].value;if(d.length){var g,b,c;g=0;for(b=d.length;g<b;g++)if(c=
d[g].fn.call(d[g].context,a,this),void 0!==c)return this.add(a,c,!0)}},remove:function(a){var g=e[a];g&&!0===g.rewritable&&delete e[a];return g?g.value:void 0},exists:function(a){return!!e[a]},eachEntry:function(a,g){for(var b in e)a.call(g,e[b].value,b)},destroy:function(){this===a&&(a=null);this.remove=this.exists=this.destroy=this.get=this.add=m=e=null}}};h.global=function(){a||(a=new h(!0));return a};return h}(),x=function(){var a=function(a,e,d){d=d||new C(!1);var n=e?e.length:null;a||(a="undefined"!=
typeof global?global:window);var g=function(c){return c&&e&&c.substr(0,n)!=e?e+"."+c:c},b=function(c,b){c=g(c);if(d.exists(c))return d.get(c);if(!b){var k=c.split("."),p,r=k.length,l,f=a;for(p=0;p<r;p++)if(l=k[p],e&&0==p&&l==e)f=a;else{if(void 0===f[l])return;f=f[l]}f&&d.add(c,f);return f}};this.register=function(c,b){var k;k=g(c);var p=k.split("."),r,l=p.pop();r=p.join(".");var f=p.length,u,q=a;if(d[r])k=[d[r],l,k];else{if(0<f)for(r=0;r<f;r++)u=p[r],e&&0==r&&u==e?q=a:(void 0===q[u]&&(q[u]={}),q=
q[u]);k=[q,l,k]}p=k[0];l=k[1];y(p)&&void 0===p[l]&&(p[l]=b,d.add(k[2],b));return b};this.exists=function(c){return void 0!==b(c,!0)};this.get=b;this.add=function(c,a){c=g(c);d.add(c,a);return a};this.remove=function(a){a=g(a);d.remove(a)};this.normalize=g;this.makeAlias=function(a,b){a=g(a);b=g(b);var e=d.get(a);void 0!==e&&d.add(b,e)};this.destroy=function(){var a;this===h&&(h=null);d.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});d.destroy();d=null;for(a in this)this[a]=null}};a.prototype.register=
null;a.prototype.exists=null;a.prototype.get=null;a.prototype.add=null;a.prototype.remove=null;a.prototype.normalize=null;a.prototype.makeAlias=null;a.prototype.destroy=null;var h;a.global=function(){h||(h=new a);return h};return a}(),A=Array.prototype.slice,D=function(){return function h(){var m=!1,e=!1,d=A.call(arguments),n=d.shift(),g,b,c;z(d[d.length-1])&&(m=d.pop());z(d[d.length-1])&&(e=m,m=d.pop());for(;d.length;)if(g=d.shift())for(b in g)if(g.hasOwnProperty(b)&&void 0!==(c=g[b]))if(e)if(n[b]&&
w(n[b])&&w(c))h(n[b],c,m,e);else{if(!0===m||void 0==n[b])w(c)?(n[b]={},h(n[b],c,m,!0)):n[b]=c}else if(!0===m||void 0==n[b])n[b]=c;return n}}(),E=function(a,h){var m=function(){},e;m.prototype=a.prototype;m=new m;e=a.apply(m,h);return y(e)||!1===e?e:m},F=function(a,h,m,e,d,n){d=d||"before";return function(){var g,b;if("instead"==d)return h.apply(m||e,arguments);"before"==d?(g=h.apply(m||e,arguments),b=!1!==g?a.apply(e||m,arguments):null):(b=a.apply(e||m,arguments),g=h.apply(m||e,arguments));return n?
g:b}},G=function(){var a=function(){this.$super&&this.$super!==s&&this.$super.apply(this,arguments)},h=function(a,b,c){var $super=a.prototype[b]||("$constructor"==b?a:s)||s;return function(){var a,p=this.$super;this.$super=$super;a=c.apply(this,arguments);this.$super=p;return a}},m=function(a,b,c,e){var d,p,r,l=c.prototype;for(d in b)b.hasOwnProperty(d)&&(r=l[d],p=b[d],a[d]="function"!=typeof p||r&&"function"!=typeof r?p:h(c,d,p));e||(a.$plugins=null,l.$beforeInit?(a.$beforeInit=l.$beforeInit.slice(),
a.$afterInit=l.$afterInit.slice(),a.$beforeDestroy=l.$beforeDestroy.slice(),a.$afterDestroy=l.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},e=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("$beforeInit"==c?a.$beforeInit.push(b[c]):"$afterInit"==c?a.$afterInit.push(b[c]):"$beforeDestroy"==c?a.$beforeDestroy.push(b[c]):"$afterDestroy"==c?a.$afterDestroy.push(b[c]):a[c]||(a[c]=b[c]))},d=function(g){g||(g=new x);var b=function(){return function(){var a=
[],c=[],l=arguments,f,b,d,e,m;if(!this)throw"Must instantiate via new";this.$plugins=[];(f=this.$constructor.apply(this,arguments))&&"object"==typeof f&&5===v(f)&&(l=f);d=this.$plugins;f=-1;for(b=this.$beforeInit.length;++f<b;a.push([this.$beforeInit[f],this]));f=-1;for(b=this.$afterInit.length;++f<b;c.push([this.$afterInit[f],this]));if(d&&d.length)for(f=0,b=d.length;f<b;f++){e=d[f];if(t(e)&&(m=e,e=g.get("plugin."+e,!0),!e))throw m+" not found";e=new e(this,l);e.$beforeHostInit&&a.push([e.$beforeHostInit,
e]);e.$afterHostInit&&c.push([e.$afterHostInit,e]);d[f]=e}f=-1;for(b=a.length;++f<b;a[f][0].apply(a[f][1],l));this.$init&&this.$init.apply(this,l);f=-1;for(b=c.length;++f<b;c[f][0].apply(c[f][1],l));}},c=function(){};D(c.prototype,{$class:null,$extends:null,$plugins:null,$mixins:null,$destroyed:!1,$constructor:s,$init:s,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$getParentClass:function(){return this.$extends},$intercept:function(a,c,b,
f,e){this[a]=F(this[a],c,b||this,this,f,e)},$implement:function(a){var c=this.constructor;c&&c.$parent&&m(this,a,c.$parent)},$destroy:function(){var a=this.$beforeDestroy,c=this.$afterDestroy,b=this.$plugins,f,e,d;if(!this.$destroyed){this.$destroyed=!0;f=-1;for(e=a.length;++f<e;a[f].apply(this,arguments));f=0;for(e=b.length;f<e;f++)b[f].$beforeHostDestroy&&b[f].$beforeHostDestroy.call(b[f],arguments);d=this.destroy.apply(this,arguments);f=-1;for(e=a.length;++f<e;c[f].apply(this,arguments));f=0;for(e=
b.length;f<e;f++)b[f].$destroy.apply(b[f],arguments);if(!1!==d)for(f in this)this.hasOwnProperty(f)&&(this[f]=null);this.$destroyed=!0}},destroy:function(){}});c.$self=c;c.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return E(this,a)}};c.$override=function(a){var b=this.$self,c=this.$parent;b&&c&&m(b.prototype,
a,c)};c.$extend=function(a,b){return h(a,b,this)};c.$destroy=function(){for(var a in this)this[a]=null};var h=function(d,r,l){d=d||{};var f=d.$class,h=l||d.$extends,q=d.$mixins,n,k,s;h?t(h)?l=g.get(h):(l=h,h=l.$class||""):(l=c,h="");if(h&&!l)throw h+" not found";f&&(f=g.normalize(f));d.$class=f;d.$extends=h;d.$mixins=null;n=function(){};n.prototype=l.prototype;h=new n;n=null;d.$constructor=d.$constructor||a;m(h,d,l);if(q)for(d=0,n=q.length;d<n;d++)s=q[d],t(s)&&(s=g.get("mixin."+s,!0)),e(h,s);q=b();
h.constructor=q;q.prototype=h;for(k in c)"prototype"!=k&&c.hasOwnProperty(k)&&(q[k]=c[k]);for(k in l)"prototype"!=k&&l.hasOwnProperty(k)&&(q[k]=l[k]);if(r)for(k in r)"prototype"!=k&&r.hasOwnProperty(k)&&(q[k]=r[k]);q.$parent=l;q.$self=q;f&&g.register(f,q);return q},k=this;k.factory=function(a){var b=g.get(a),c=A.call(arguments,1);if(!b)throw a+" not found";return b.$instantiate.apply(b,c)};k.isSubclassOf=function(a,b){var c=a,d=g.get;b=t(b)?g.normalize(b):b.prototype.$class;for(t(a)&&(c=d(g.normalize(a)));c&&
c.prototype;){if(c.prototype.$class==b)return!0;c=c.$parent}return!1};k.isInstanceOf=function(a,b){var c=t(b)?g.get(b):b;return c?a instanceof c:!1};k.define=h;k.destroy=function(){k===n&&(n=null);c.$destroy();c=null;g.destroy();d=g=null};k.BaseClass=c};d.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,destroy:null};var n;d.global=function(){n||(n=new d(x.global()));return n};return d}();MetaphorJs.Namespace=x;MetaphorJs.Class=G;"undefined"!=typeof global?global.MetaphorJs=
MetaphorJs:window.MetaphorJs=MetaphorJs})();
