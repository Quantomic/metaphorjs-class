'use strict';define("metaphorjs-class",["metaphorjs-namespace"],function(x){function s(e){return"string"==typeof e||e===""+e}function u(e){return"object"==typeof e&&3===v(e)&&!e.nodeType&&e.constructor===Object}function y(e){return!0===e||!1===e}function t(){}function A(e){if(null===e||"object"!=typeof e)return!1;e=v(e);return 2<e||-1==e}function B(e,m,b,q,k,n){k=k||"before";return function(){var c,l;if("instead"==k)return m.apply(b||q,arguments);"before"==k?(c=m.apply(b||q,arguments),l=!1!==c?e.apply(q||
b,arguments):null):(l=e.apply(q||b,arguments),c=m.apply(b||q,arguments));return n?c:l}}var C=Object.prototype.toString,v=function(){var e={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(m){if(!m){if(null===m)return 6;if(void 0===m)return 7}var b=e[C.call(m)];return void 0===b?-1:1==b&&isNaN(m)?8:b}}(),z=Array.prototype.slice,D=function(){return function m(){var b=!1,q=
!1,k=z.call(arguments),n=k.shift(),c,l,a;y(k[k.length-1])&&(b=k.pop());y(k[k.length-1])&&(q=b,b=k.pop());for(;k.length;)if(c=k.shift())for(l in c)if(c.hasOwnProperty(l)&&void 0!==(a=c[l]))if(q)if(n[l]&&u(n[l])&&u(a))m(n[l],a,b,q);else{if(!0===b||void 0==n[l])u(a)?(n[l]={},m(n[l],a,b,!0)):n[l]=a}else if(!0===b||void 0==n[l])n[l]=a;return n}}(),E=function(e,m){var b=function(){},q;b.prototype=e.prototype;b=new b;q=e.apply(b,m);return A(q)||!1===q?q:b};return function(){var e=function(){this.$super&&
this.$super!==t&&this.$super.apply(this,arguments)},m=function(c,l,a){var $super=c.prototype[l]||("$constructor"==l?c:t)||t;return function(){var c,g=this.$super;this.$super=$super;c=a.apply(this,arguments);this.$super=g;return c}},b=function(c,l,a,e){var b,g,w,f=a.prototype;for(b in l)l.hasOwnProperty(b)&&(w=f[b],g=l[b],c[b]="function"!=typeof g||w&&"function"!=typeof w?g:m(a,b,g));e||(c.$plugins=null,c.$pluginMap=null,f.$beforeInit?(c.$beforeInit=f.$beforeInit.slice(),c.$afterInit=f.$afterInit.slice(),
c.$beforeDestroy=f.$beforeDestroy.slice(),c.$afterDestroy=f.$afterDestroy.slice()):(c.$beforeInit=[],c.$afterInit=[],c.$beforeDestroy=[],c.$afterDestroy=[]))},q=function(c,b){for(var a in b)b.hasOwnProperty(a)&&("$beforeInit"==a?c.$beforeInit.push(b[a]):"$afterInit"==a?c.$afterInit.push(b[a]):"$beforeDestroy"==a?c.$beforeDestroy.push(b[a]):"$afterDestroy"==a?c.$afterDestroy.push(b[a]):c[a]||(c[a]=b[a]))},k=function(c){c||(c=new x);var l=function(g){return function(){var b=[],f=[],a=arguments,d,p,
e,h,l,k;if(!this)throw"Must instantiate via new: "+g;this.$plugins=[];(d=this.$constructor.apply(this,arguments))&&"object"==typeof d&&5===v(d)&&(a=d);e=this.$plugins;l=this.$pluginMap={};d=-1;for(p=this.$beforeInit.length;++d<p;b.push([this.$beforeInit[d],this]));d=-1;for(p=this.$afterInit.length;++d<p;f.push([this.$afterInit[d],this]));if(e&&e.length)for(d=0,p=e.length;d<p;d++){h=e[d];if(s(h)&&(k=h,h=c.get(h,!0),!h))throw k+" not found";h=new h(this,a);l[h.$class]=h;h.$beforeHostInit&&b.push([h.$beforeHostInit,
h]);h.$afterHostInit&&f.push([h.$afterHostInit,h]);e[d]=h}d=-1;for(p=b.length;++d<p;b[d][0].apply(b[d][1],a));this.$init&&this.$init.apply(this,a);d=-1;for(p=f.length;++d<p;f[d][0].apply(f[d][1],a));}},a=function(){};D(a.prototype,{$class:null,$extends:null,$plugins:null,$pluginMap:null,$mixins:null,$destroyed:!1,$constructor:t,$init:t,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$getParentClass:function(){return this.$extends},$intercept:function(g,
c,f,b,d){var a=this[g];this[g]=B(a,c,f||this,this,b,d);return a},$implement:function(g){var c=this.constructor;c&&c.$parent&&b(this,g,c.$parent)},$hasPlugin:function(g){return!!this.$pluginMap[c.normalize(g)]},$getPlugin:function(g){return this.$pluginMap[c.normalize(g)]||null},$destroy:function(){var g=this.$beforeDestroy,c=this.$afterDestroy,b=this.$plugins,a,d,e;if(!this.$destroyed){this.$destroyed=!0;a=-1;for(d=g.length;++a<d;g[a].apply(this,arguments));a=0;for(d=b.length;a<d;a++)b[a].$beforeHostDestroy&&
b[a].$beforeHostDestroy.call(b[a],arguments);e=this.destroy.apply(this,arguments);a=-1;for(d=g.length;++a<d;c[a].apply(this,arguments));a=0;for(d=b.length;a<d;a++)b[a].$destroy.apply(b[a],arguments);if(!1!==e)for(a in this)this.hasOwnProperty(a)&&(this[a]=null);this.$destroyed=!0}},destroy:function(){}});a.$self=a;a.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],
a[1],a[2],a[3]);default:return E(this,a)}};a.$override=function(a){var c=this.$self,f=this.$parent;c&&f&&b(c.prototype,a,f)};a.$extend=function(a,c){return m(a,c,this)};a.$destroy=function(){for(var a in this)this[a]=null};var m=function(g,k,f){g=g||{};var m=g.$class,d=f||g.$extends,p=g.$mixins,n,h,r;d?s(d)?f=c.get(d):(f=d,d=f.$class||""):(f=a,d="");if(d&&!f)throw d+" not found";m&&(m=c.normalize(m));g.$class=m;g.$extends=d;g.$mixins=null;n=function(){};n.prototype=f.prototype;d=new n;n=null;g.$constructor=
g.$constructor||e;b(d,g,f);if(p)for(g=0,n=p.length;g<n;g++)r=p[g],s(r)&&(r=c.get(r,!0)),q(d,r);p=l(m);d.constructor=p;p.prototype=d;for(h in a)"prototype"!=h&&a.hasOwnProperty(h)&&(p[h]=a[h]);for(h in f)"prototype"!=h&&f.hasOwnProperty(h)&&(p[h]=f[h]);if(k)for(h in k)"prototype"!=h&&k.hasOwnProperty(h)&&(p[h]=k[h]);p.$parent=f;p.$self=p;m&&c.register(m,p);return p},r=this;r.factory=function(a){var b=c.get(a),f=z.call(arguments,1);if(!b)throw a+" not found";return b.$instantiate.apply(b,f)};r.isSubclassOf=
function(a,b){var f=a,e=c.get;b=s(b)?c.normalize(b):b.prototype.$class;for(s(a)&&(f=e(c.normalize(a)));f&&f.prototype;){if(f.prototype.$class==b)return!0;f=f.$parent}return!1};r.isInstanceOf=function(a,b){var e=s(b)?c.get(b):b;return e?a instanceof e:!1};r.define=m;r.destroy=function(){r===n&&(n=null);a.$destroy();a=null;c.destroy();k=c=null};r.BaseClass=a};k.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,destroy:null};var n;k.global=function(){n||(n=new k(x.global()));return n};
return k}()});
