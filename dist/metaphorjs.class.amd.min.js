'use strict';define("metaphorjs-class",["metaphorjs-namespace"],function(w){function s(g){return"string"==typeof g||g===""+g}function t(g){return"object"==typeof g&&3===u(g)&&!g.nodeType&&g.constructor===Object}function x(g){return!0===g||!1===g}function r(){}function z(g){if(null===g||"object"!=typeof g)return!1;g=u(g);return 2<g||-1==g}var A=Object.prototype.toString,u=function(){var g={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,
"[object RegExp]":9,"[object Date]":10};return function(h){if(!h){if(null===h)return 6;if(void 0===h)return 7}var b=g[A.call(h)];return void 0===b?-1:1==b&&isNaN(h)?8:b}}(),y=Array.prototype.slice,B=function(){return function h(){var b=!1,n=!1,l=y.call(arguments),k=l.shift(),c,e,a;x(l[l.length-1])&&(b=l.pop());x(l[l.length-1])&&(n=b,b=l.pop());for(;l.length;)if(c=l.shift())for(e in c)if(c.hasOwnProperty(e)&&void 0!==(a=c[e]))if(n)if(k[e]&&t(k[e])&&t(a))h(k[e],a,b,n);else{if(!0===b||void 0==k[e])t(a)?
(k[e]={},h(k[e],a,b,!0)):k[e]=a}else if(!0===b||void 0==k[e])k[e]=a;return k}}(),C=function(g,h){var b=function(){},n;b.prototype=g.prototype;b=new b;n=g.apply(b,h);return z(n)||!1===n?n:b},D=function(g,h,b,n,l,k){l=l||"before";return function(){var c,e;if("instead"==l)return h.apply(b||n,arguments);"before"==l?(c=h.apply(b||n,arguments),e=!1!==c?g.apply(n||b,arguments):null):(e=g.apply(n||b,arguments),c=h.apply(b||n,arguments));return k?c:e}};return function(){var g=function(){this.$super&&this.$super!==
r&&this.$super.apply(this,arguments)},h=function(c,e,a){var $super=c.prototype[e]||("$constructor"==e?c:r)||r;return function(){var c,d=this.$super;this.$super=$super;c=a.apply(this,arguments);this.$super=d;return c}},b=function(c,e,a,g){var b,d,v,m=a.prototype;for(b in e)e.hasOwnProperty(b)&&(v=m[b],d=e[b],c[b]="function"!=typeof d||v&&"function"!=typeof v?d:h(a,b,d));g||(c.$plugins=null,m.$beforeInit?(c.$beforeInit=m.$beforeInit.slice(),c.$afterInit=m.$afterInit.slice(),c.$beforeDestroy=m.$beforeDestroy.slice(),
c.$afterDestroy=m.$afterDestroy.slice()):(c.$beforeInit=[],c.$afterInit=[],c.$beforeDestroy=[],c.$afterDestroy=[]))},n=function(c,b){for(var a in b)b.hasOwnProperty(a)&&("$beforeInit"==a?c.$beforeInit.push(b[a]):"$afterInit"==a?c.$afterInit.push(b[a]):"$beforeDestroy"==a?c.$beforeDestroy.push(b[a]):"$afterDestroy"==a?c.$afterDestroy.push(b[a]):c[a]||(c[a]=b[a]))},l=function(c){c||(c=new w);var e=function(){return function(){var d=[],b=[],m=arguments,f,a,g,e,l;if(!this)throw"Must instantiate via new";
this.$plugins=[];(f=this.$constructor.apply(this,arguments))&&"object"==typeof f&&5===u(f)&&(m=f);g=this.$plugins;f=-1;for(a=this.$beforeInit.length;++f<a;d.push([this.$beforeInit[f],this]));f=-1;for(a=this.$afterInit.length;++f<a;b.push([this.$afterInit[f],this]));if(g&&g.length)for(f=0,a=g.length;f<a;f++){e=g[f];if(s(e)&&(l=e,e=c.get("plugin."+e,!0),!e))throw l+" not found";e=new e(this,m);e.$beforeHostInit&&d.push([e.$beforeHostInit,e]);e.$afterHostInit&&b.push([e.$afterHostInit,e]);g[f]=e}f=-1;
for(a=d.length;++f<a;d[f][0].apply(d[f][1],m));this.$init&&this.$init.apply(this,m);f=-1;for(a=b.length;++f<a;b[f][0].apply(b[f][1],m));}},a=function(){};B(a.prototype,{$class:null,$extends:null,$plugins:null,$mixins:null,$destroyed:!1,$constructor:r,$init:r,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$getParentClass:function(){return this.$extends},$intercept:function(d,a,b,f,c){this[d]=D(this[d],a,b||this,this,f,c)},$implement:function(d){var a=
this.constructor;a&&a.$parent&&b(this,d,a.$parent)},$destroy:function(){var d=this.$beforeDestroy,a=this.$afterDestroy,b=this.$plugins,f,c,e;if(!this.$destroyed){this.$destroyed=!0;f=-1;for(c=d.length;++f<c;d[f].apply(this,arguments));f=0;for(c=b.length;f<c;f++)b[f].$beforeHostDestroy&&b[f].$beforeHostDestroy();e=this.destroy();f=-1;for(c=d.length;++f<c;a[f].apply(this,arguments));f=0;for(c=b.length;f<c;f++)b[f].$destroy();if(!1!==e)for(f in this)this.hasOwnProperty(f)&&(this[f]=null);this.$destroyed=
!0}},destroy:function(){}});a.$self=a;a.$instantiate=function(){var d=arguments;switch(d.length){case 0:return new this;case 1:return new this(d[0]);case 2:return new this(d[0],d[1]);case 3:return new this(d[0],d[1],d[2]);case 4:return new this(d[0],d[1],d[2],d[3]);default:return C(this,d)}};a.$override=function(d){var c=this.$self,a=this.$parent;c&&a&&b(c.prototype,d,a)};a.$extend=function(d,c){return h(d,c,this)};a.$destroy=function(){for(var d in this)this[d]=null};var h=function(d,l,m){d=d||{};
var f=d.$class,h=m||d.$extends,k=d.$mixins,q,p,r;h?s(h)?m=c.get(h):(m=h,h=m.$class||""):(m=a,h="");if(h&&!m)throw h+" not found";f&&(f=c.normalize(f));d.$class=f;d.$extends=h;d.$mixins=null;q=function(){};q.prototype=m.prototype;h=new q;q=null;d.$constructor=d.$constructor||g;b(h,d,m);if(k)for(d=0,q=k.length;d<q;d++)r=k[d],s(r)&&(r=c.get("mixin."+r,!0)),n(h,r);k=e();h.constructor=k;k.prototype=h;for(p in a)"prototype"!=p&&a.hasOwnProperty(p)&&(k[p]=a[p]);for(p in m)"prototype"!=p&&m.hasOwnProperty(p)&&
(k[p]=m[p]);if(l)for(p in l)"prototype"!=p&&l.hasOwnProperty(p)&&(k[p]=l[p]);k.$parent=m;k.$self=k;f&&c.register(f,k);return k},q=this;q.factory=function(d){var a=c.get(d),b=y.call(arguments,1);if(!a)throw d+" not found";return a.$instantiate.apply(a,b)};q.isSubclassOf=function(a,b){var e=a,f=c.get;b=s(b)?c.normalize(b):b.prototype.$class;for(s(a)&&(e=f(c.normalize(a)));e&&e.prototype;){if(e.prototype.$class==b)return!0;e=e.$parent}return!1};q.isInstanceOf=function(a,b){var e=s(b)?c.get(b):b;return e?
a instanceof e:!1};q.define=h;q.destroy=function(){q===k&&(k=null);a.$destroy();a=null;c.destroy();l=c=null};q.BaseClass=a};l.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,destroy:null};var k;l.global=function(){k||(k=new l(w.global()));return k};return l}()});
